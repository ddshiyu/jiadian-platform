var st=Object.defineProperty,ut=Object.defineProperties;var dt=Object.getOwnPropertyDescriptors;var Ae=Object.getOwnPropertySymbols;var it=Object.prototype.hasOwnProperty,mt=Object.prototype.propertyIsEnumerable;var Te=(T,M,S)=>M in T?st(T,M,{enumerable:!0,configurable:!0,writable:!0,value:S}):T[M]=S,$e=(T,M)=>{for(var S in M||(M={}))it.call(M,S)&&Te(T,S,M[S]);if(Ae)for(var S of Ae(M))mt.call(M,S)&&Te(T,S,M[S]);return T},Oe=(T,M)=>ut(T,dt(M));var Y=(T,M,S)=>new Promise((K,ee)=>{var z=k=>{try{d(S.next(k))}catch(v){ee(v)}},q=k=>{try{d(S.throw(k))}catch(v){ee(v)}},d=k=>k.done?K(k.value):Promise.resolve(k.value).then(z,q);d((S=S.apply(T,M)).next())});import{N as pt,O as vt,P as Q,Q as ft,R as A,U as le,W as ke,X as C,S as ge,B as N,Y as ct,Z as F,a0 as ne,a1 as X,a2 as be,a3 as yt,a4 as kt,b as _,_ as gt}from"./bootstrap-PxKnX6yB.js";import{d as bt,r as I,I as V,o as _t,a as g,b as m,A as l,z as a,g as t,B as s,f as p,e as f,l as b,t as u,G as Re,H as Fe,J as ht}from"../jse/index-index-D7J90qLZ.js";import{g as St,a as Mt,b as wt,c as Ct,r as It,s as Nt,h as Dt,d as At}from"./operation-Be0XMEqK.js";import{C as Ue,T as Tt,a as xe,P as $t}from"./index-G_a0DtsV.js";import{R as Ot}from"./ReloadOutlined-CDcl3Iv1.js";import{D as re,a as y}from"./index-D09GitlA.js";import{T as _e}from"./index-C7aTtTZL.js";import{P as Pe}from"./index-DLFp5g9l.js";const Rt={class:"table-header"},Ft={class:"table-action"},Ut={key:0},xt={key:1,class:"price"},Pt={key:5,class:"price"},qt={key:6},Yt={key:0},zt={key:0},jt={key:1,class:"price"},Lt={key:5,class:"price"},Zt={key:6},Bt={key:0},Vt={key:0},Ht={class:"payment-qrcodes"},Gt={class:"qrcode-header"},Et={class:"qrcode-name"},Jt={class:"qrcode-image"},Wt=["src","alt"],Qt={class:"payment-bankcards"},Xt={class:"bankcard-info"},Kt={class:"bankcard-row"},ea={class:"bankcard-value"},ta={class:"bankcard-row"},aa={class:"bankcard-value"},la={class:"bankcard-row"},na={class:"bankcard-value"},ra={key:0,class:"product-info"},oa=["src"],sa={key:1,class:"price"},ua={key:2,class:"price"},da={key:0},ia={key:1},ma=bt({__name:"orders",setup(T){const{RangePicker:M}=pt,S=vt(),K=[{title:"订单信息",key:"orderInfo",width:200},{title:"订单金额",key:"amount",width:100},{title:"订单状态",key:"status",width:120},{title:"支付状态",key:"paymentStatus",width:120},{title:"结算状态",key:"settlementStatus",width:120},{title:"结算金额",key:"settlementAmount",width:120},{title:"时间信息",key:"time",width:200},{title:"操作",key:"action",width:200}],ee=[{title:"商品信息",key:"product",width:"40%"},{title:"单价",key:"price",width:"15%"},{title:"数量",dataIndex:"quantity",key:"quantity",width:"15%"},{title:"金额",key:"total",width:"15%"}],z=I([]),q=I(!1),d=I(null),k=V({current:1,pageSize:10,total:0,showSizeChanger:!0,showQuickJumper:!0,showTotal:r=>`共 ${r} 条记录`}),v=V({orderNo:"",userName:"",status:"",paymentStatus:"",startDate:"",endDate:""}),j=I(void 0),te=I(!1),H=I(!1),L=V({orderId:0,remark:""}),oe=I(null),qe={remark:[{required:!0,message:"请输入订单备注",trigger:"blur",type:"string"}]},$=I(!1),G=I(!1),D=V({orderId:0,trackingNumber:"",trackingCompany:"",deliveryImages:[]}),se=I(null),Ye={trackingNumber:[{required:!0,message:"请输入快递单号",trigger:"blur",type:"string"}],trackingCompany:[{required:!0,message:"请输入快递公司",trigger:"blur",type:"string"}]},B=I([]),ze={Authorization:`Bearer ${S.accessToken}`},je="https://qbylxb.cn/upload/image",Le=r=>{const e=r.type==="image/jpeg"||r.type==="image/png";e||_.error("只能上传JPG或PNG格式的图片!");const n=r.size/1024/1024<2;return n||_.error("图片大小不能超过2MB!"),e&&n},Ze=r=>{const e=[...r.fileList].slice(0,5);if(B.value=e,r.file.status==="done"){const n=r.file.response;n&&n.code===0?(D.deliveryImages=B.value.filter(o=>{var i,c,h;return((h=(c=(i=o.response)==null?void 0:i.data)==null?void 0:c.image)==null?void 0:h.url)||o.url}).map(o=>{var i,c,h;return`https://qbylxb.cn${(h=(c=(i=o.response)==null?void 0:i.data)==null?void 0:c.image)==null?void 0:h.url}`}),_.success(`${r.file.name} 上传成功`)):_.error(`${r.file.name} 上传失败`)}else r.file.status==="error"&&_.error(`${r.file.name} 上传失败`)},E=I(!1),O=V({orderId:0,status:"",remark:""}),ue=I(null),Be={status:[{required:!0,message:"请选择操作结果",trigger:"change",type:"string"}]},J=I(!1),R=V({orderId:0,settlementAmount:0,remark:""}),de=I(null),Ve={settlementAmount:[{required:!0,message:"请输入结算金额",trigger:"change",type:"number"},{min:.01,message:"结算金额必须大于0.01",trigger:"change",type:"number"}]},ae=I("all"),He=r=>{ae.value=r,he()},U=()=>Y(this,null,function*(){var r,e;q.value=!0;try{j.value&&j.value.length===2?(v.startDate=j.value[0].format("YYYY-MM-DD"),v.endDate=j.value[1].format("YYYY-MM-DD")):(v.startDate="",v.endDate="");const n={orderNo:v.orderNo,userName:v.userName,status:v.status||void 0,paymentStatus:v.paymentStatus||void 0,startDate:v.startDate||void 0,endDate:v.endDate||void 0,pageNum:k.current,pageSize:k.pageSize};try{const o=ae.value==="refund"?yield St(n):yield Mt(n);if(o)z.value=o.list||[],k.total=((r=o.pagination)==null?void 0:r.total)||0,k.current=((e=o.pagination)==null?void 0:e.current)||1;else throw new Error("获取订单列表失败: 空响应")}catch(o){console.error("获取订单API失败，使用模拟数据:",o),_.warning(`当前使用测试数据，接口异常：${o.message||o}`);let c=[...Ge()];v.orderNo&&(c=c.filter(Z=>Z.orderNo.includes(v.orderNo))),v.userName&&(c=c.filter(Z=>Z.userName.includes(v.userName))),v.status&&(c=c.filter(Z=>Z.status===v.status)),v.paymentStatus&&(c=c.filter(Z=>Z.paymentStatus===v.paymentStatus));const h=k.current||1,P=k.pageSize||10,w=(h-1)*P,W=w+P;z.value=c.slice(w,W),k.total=c.length}}catch(n){console.error("获取订单列表失败:",n),_.error("获取订单列表失败"),z.value=[],k.total=0}finally{q.value=!1}}),Ge=()=>{const r=["pending_payment","pending_delivery","delivered","completed","cancelled","refund_pending","refund_processing","refund_approved","refund_rejected"],e=["unpaid","paid","refunded"],n=["normal","vip","wholesale"];return Array.from({length:25}).map((o,i)=>{const c=r[Math.floor(Math.random()*r.length)],h=c==="pending_payment"?"unpaid":c==="cancelled"?e[Math.floor(Math.random()*e.length)]:"paid",P={id:i+1,orderNo:`ORD${String(i+10001).padStart(5,"0")}`,userId:i+100,userName:`测试用户${i+1}`,totalAmount:Number(Math.floor(Math.random()*1e4)/100+100),orderType:n[Math.floor(Math.random()*n.length)],status:c,paymentStatus:h,paymentMethod:h==="unpaid"?void 0:"微信支付",settlementStatus:c==="completed"&&h==="paid"?Math.random()>.7?"settled":Math.random()>.5?"settling":"unsettled":"unsettled",settlementTime:c==="completed"&&h==="paid"&&Math.random()>.5?new Date(Date.now()-Math.random()*864e5*7).toISOString():void 0,settlementAmount:c==="completed"&&h==="paid"&&Math.random()>.5?Number((Math.floor(Math.random()*1e4)/100+100)*.95):void 0,settlementRemark:c==="completed"&&h==="paid"&&Math.random()>.5?`订单结算完成${i+1}`:void 0,paymentTime:h==="unpaid"?void 0:new Date(Date.now()-Math.random()*864e5*30).toISOString(),deliveryTime:["completed","delivered"].includes(c)?new Date(Date.now()-Math.random()*864e5*15).toISOString():void 0,completionTime:c==="completed"?new Date(Date.now()-Math.random()*864e5*5).toISOString():void 0,cancelTime:c==="cancelled"?new Date(Date.now()-Math.random()*864e5*10).toISOString():void 0,remark:Math.random()>.7?`订单备注${i+1}`:void 0,address:`测试地址${i+1}`,consignee:`收货人${i+1}`,phone:`1380000${String(i+1).padStart(4,"0")}`,createdAt:new Date(Date.now()-Math.random()*864e5*60).toISOString(),updatedAt:new Date(Date.now()-Math.random()*864e5*30).toISOString(),merchant:{id:Math.floor(i/5)+1,username:`merchant${Math.floor(i/5)+1}`,name:`商家${Math.floor(i/5)+1}`,phone:`1380000${String(Math.floor(i/5)+1).padStart(4,"0")}`,email:`merchant${Math.floor(i/5)+1}@example.com`,role:Math.random()>.8?"admin":"user",paymentMethods:{qrCodes:[{type:"wechat",imageUrl:`https://via.placeholder.com/200x200?text=微信收款码${Math.floor(i/5)+1}`,name:`微信收款码${Math.floor(i/5)+1}`},{type:"alipay",imageUrl:`https://via.placeholder.com/200x200?text=支付宝收款码${Math.floor(i/5)+1}`,name:`支付宝收款码${Math.floor(i/5)+1}`}],bankCards:[{bankName:"中国银行",cardNumber:`6217000${String(Math.floor(i/5)+1).padStart(10,"0")}`,accountName:`商家${Math.floor(i/5)+1}`},{bankName:"招商银行",cardNumber:`6225000${String(Math.floor(i/5)+1).padStart(10,"0")}`,accountName:`商家${Math.floor(i/5)+1}`}]}},items:[{id:i*2+1,productId:i*3+100,productName:`测试商品${i*2+1}`,price:Math.floor(Math.random()*1e3)/100+50,quantity:Math.floor(Math.random()*5)+1,totalAmount:0,productCover:`https://via.placeholder.com/100?text=商品${i*2+1}`},{id:i*2+2,productId:i*3+101,productName:`测试商品${i*2+2}`,price:Math.floor(Math.random()*1e3)/100+50,quantity:Math.floor(Math.random()*5)+1,totalAmount:0,productCover:`https://via.placeholder.com/100?text=商品${i*2+2}`}]};return P.items=P.items.map(w=>Oe($e({},w),{totalAmount:w.price*w.quantity})),P})},Ee=()=>{k.current=1,U()},he=()=>{Object.assign(v,{orderNo:"",userName:"",status:"",paymentStatus:"",startDate:"",endDate:""}),j.value=void 0,k.current=1,U()},Se=r=>{k.current=r.current,k.pageSize=r.pageSize,U()},Me=r=>Y(this,null,function*(){try{q.value=!0;try{const e=yield wt(r.id);if(e)d.value=e,te.value=!0;else throw new Error("订单详情获取失败: 空响应")}catch(e){console.error("获取订单详情API失败，使用模拟数据:",e),_.warning(`当前使用测试数据，接口异常：${e.message||e}`),d.value=r,te.value=!0}}catch(e){console.error("获取订单详情失败:",e),_.error("获取订单详情失败")}finally{q.value=!1}}),we=r=>Y(this,null,function*(){try{yield Ct(r.id,"管理员取消"),_.success("订单已取消"),U()}catch(e){console.error("取消订单失败:",e),_.error("取消订单失败")}}),Ce=r=>{L.orderId=r.id,L.remark=r.remark||"",H.value=!0},Je=()=>{H.value=!1},We=()=>Y(this,null,function*(){if(oe.value)try{yield oe.value.validate(),$.value=!0,yield It(L.orderId,L.remark),_.success("备注成功"),H.value=!1,U()}catch(r){console.error("备注失败:",r),_.error("备注失败")}finally{$.value=!1}}),Ie=r=>{D.orderId=r.id,D.trackingNumber="",D.trackingCompany="",D.deliveryImages=[],B.value=[],G.value=!0},Qe=()=>{G.value=!1},Xe=()=>Y(this,null,function*(){if(se.value)try{yield se.value.validate(),$.value=!0,yield Nt(D.orderId,D.trackingNumber,D.trackingCompany,D.deliveryImages),_.success("发货成功"),G.value=!1,U()}catch(r){console.error("发货失败:",r),_.error("发货失败")}finally{$.value=!1}}),Ne=r=>{O.orderId=r.id,O.status="",O.remark="",E.value=!0},Ke=()=>{E.value=!1},et=()=>Y(this,null,function*(){if(ue.value)try{yield ue.value.validate(),$.value=!0;const r=O.status,e=O.remark||void 0;yield Dt(O.orderId,r,e),_.success(O.status==="approved"?"退款申请已通过":"退款申请已拒绝"),E.value=!1,U()}catch(r){console.error("处理退款失败:",r),_.error("处理退款失败")}finally{$.value=!1}}),De=r=>{R.orderId=r.id,R.settlementAmount=Number(r.totalAmount),R.remark="",J.value=!0},tt=()=>{J.value=!1},at=()=>Y(this,null,function*(){if(de.value)try{yield de.value.validate(),$.value=!0;const r=Number(R.settlementAmount);yield At(R.orderId,r,R.remark),_.success("订单结算成功"),J.value=!1,U()}catch(r){console.error("订单结算失败:",r),_.error("订单结算失败")}finally{$.value=!1}}),x=r=>r?ht(r).format("YYYY-MM-DD HH:mm:ss"):"",ie=r=>({pending_payment:"待支付",pending_delivery:"待发货",delivered:"已发货",completed:"已完成",cancelled:"已取消",refund_pending:"退款申请中",refund_processing:"退款处理中",refund_approved:"退款已通过",refund_rejected:"退款已拒绝"})[r]||r,me=r=>({pending_payment:"orange",pending_delivery:"blue",delivered:"cyan",completed:"green",cancelled:"red",refund_pending:"gold",refund_processing:"magenta",refund_approved:"purple",refund_rejected:"volcano"})[r]||"default",pe=r=>({unpaid:"未支付",paid:"已支付",refunded:"已退款"})[r]||r,ve=r=>({unpaid:"orange",paid:"green",refunded:"purple"})[r]||"default",fe=r=>({unsettled:"未结算",settling:"结算中",settled:"已结算"})[r]||r,ce=r=>({unsettled:"orange",settling:"blue",settled:"green"})[r]||"default",ye=r=>r?{normal:"普通订单",vip:"VIP订单",wholesale:"批发订单"}[r]||r:"-",lt=r=>({wechat:"微信",alipay:"支付宝",other:"其他"})[r]||r,nt=r=>({wechat:"green",alipay:"blue",other:"orange"})[r]||"default",rt=r=>{if(!r)return"-";const e=r.length;if(e<=8)return r;const n=r.slice(0,4),o=r.slice(-4),i="*".repeat(e-8);return`${n}${i}${o}`},ot=r=>{const e=r.target;e.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgdmlld0JveD0iMCAwIDEwMCAxMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxMDAiIGhlaWdodD0iMTAwIiBmaWxsPSIjRjVGNUY1Ii8+Cjx0ZXh0IHg9IjUwIiB5PSI1NSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZmlsbD0iIzk5OTk5OSIgZm9udC1zaXplPSIxMiI+5LiN5q+V6L6J5YqgPC90ZXh0Pgo8L3N2Zz4K"};return _t(()=>{U()}),(r,e)=>(m(),g("div",null,[l(t(Ue),{bordered:!1,class:"mb-20"},{default:a(()=>[l(t(Q),{model:v,layout:"inline",class:"search-form",onSubmit:ft(Ee,["prevent"])},{default:a(()=>[l(t(A),{label:"订单号"},{default:a(()=>[l(t(le),{value:v.orderNo,"onUpdate:value":e[0]||(e[0]=n=>v.orderNo=n),placeholder:"请输入订单号","allow-clear":""},null,8,["value"])]),_:1}),l(t(A),{label:"用户名"},{default:a(()=>[l(t(le),{value:v.userName,"onUpdate:value":e[1]||(e[1]=n=>v.userName=n),placeholder:"请输入用户名","allow-clear":""},null,8,["value"])]),_:1}),l(t(A),{label:"订单状态"},{default:a(()=>[l(t(ke),{value:v.status,"onUpdate:value":e[2]||(e[2]=n=>v.status=n),placeholder:"请选择订单状态",style:{width:"160px"},"allow-clear":""},{default:a(()=>[l(t(C),{value:""},{default:a(()=>e[19]||(e[19]=[s("全部")])),_:1}),l(t(C),{value:"pending_payment"},{default:a(()=>e[20]||(e[20]=[s("待支付")])),_:1}),l(t(C),{value:"pending_delivery"},{default:a(()=>e[21]||(e[21]=[s("待发货")])),_:1}),l(t(C),{value:"delivered"},{default:a(()=>e[22]||(e[22]=[s("已发货")])),_:1}),l(t(C),{value:"completed"},{default:a(()=>e[23]||(e[23]=[s("已完成")])),_:1}),l(t(C),{value:"cancelled"},{default:a(()=>e[24]||(e[24]=[s("已取消")])),_:1}),l(t(C),{value:"refund_pending"},{default:a(()=>e[25]||(e[25]=[s("退款申请中")])),_:1}),l(t(C),{value:"refund_processing"},{default:a(()=>e[26]||(e[26]=[s("退款处理中")])),_:1}),l(t(C),{value:"refund_approved"},{default:a(()=>e[27]||(e[27]=[s("退款已通过")])),_:1}),l(t(C),{value:"refund_rejected"},{default:a(()=>e[28]||(e[28]=[s("退款已拒绝")])),_:1})]),_:1},8,["value"])]),_:1}),l(t(A),{label:"支付状态"},{default:a(()=>[l(t(ke),{value:v.paymentStatus,"onUpdate:value":e[3]||(e[3]=n=>v.paymentStatus=n),placeholder:"请选择支付状态",style:{width:"140px"},"allow-clear":""},{default:a(()=>[l(t(C),{value:""},{default:a(()=>e[29]||(e[29]=[s("全部")])),_:1}),l(t(C),{value:"unpaid"},{default:a(()=>e[30]||(e[30]=[s("未支付")])),_:1}),l(t(C),{value:"paid"},{default:a(()=>e[31]||(e[31]=[s("已支付")])),_:1}),l(t(C),{value:"refunded"},{default:a(()=>e[32]||(e[32]=[s("已退款")])),_:1})]),_:1},8,["value"])]),_:1}),l(t(A),{label:"下单时间"},{default:a(()=>[l(t(M),{value:j.value,"onUpdate:value":e[4]||(e[4]=n=>j.value=n),format:"YYYY-MM-DD",placeholder:["开始日期","结束日期"],style:{width:"240px"}},null,8,["value"])]),_:1}),l(t(A),null,{default:a(()=>[l(t(ge),null,{default:a(()=>[l(t(N),{type:"primary","html-type":"submit"},{default:a(()=>e[33]||(e[33]=[s("查询")])),_:1}),l(t(N),{onClick:he},{default:a(()=>e[34]||(e[34]=[s("重置")])),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),l(t(Ue),{bordered:!1},{default:a(()=>[p("div",Rt,[e[35]||(e[35]=p("div",{class:"table-title"},"订单列表",-1)),p("div",Ft,[l(t(ct),{title:"刷新"},{default:a(()=>[l(t(N),{onClick:U},{icon:a(()=>[l(t(Ot))]),_:1})]),_:1})])]),l(t(Tt),{"active-key":ae.value,"onUpdate:activeKey":e[5]||(e[5]=n=>ae.value=n),onChange:He},{default:a(()=>[l(t(xe),{tab:"所有订单",key:"all"},{default:a(()=>[l(t(_e),{columns:K,"data-source":z.value,loading:q.value,pagination:k,onChange:Se,"row-key":"id"},{bodyCell:a(({column:n,record:o})=>[n.key==="orderInfo"?(m(),g("div",Ut,[p("div",null,"订单号: "+u(o.orderNo),1),p("div",null,"用户: "+u(o.userName),1),p("div",null,"类型: "+u(ye(o.orderType)),1)])):f("",!0),n.key==="amount"?(m(),g("div",xt," ¥"+u(Number(o.totalAmount).toFixed(2)),1)):f("",!0),n.key==="status"?(m(),b(t(F),{key:2,color:me(o.status)},{default:a(()=>[s(u(ie(o.status)),1)]),_:2},1032,["color"])):f("",!0),n.key==="paymentStatus"?(m(),b(t(F),{key:3,color:ve(o.paymentStatus)},{default:a(()=>[s(u(pe(o.paymentStatus)),1)]),_:2},1032,["color"])):f("",!0),n.key==="settlementStatus"?(m(),b(t(F),{key:4,color:ce(o.settlementStatus)},{default:a(()=>[s(u(fe(o.settlementStatus)),1)]),_:2},1032,["color"])):f("",!0),n.key==="settlementAmount"?(m(),g("div",Pt,u(o.settlementAmount?`¥${Number(o.settlementAmount).toFixed(2)}`:"-"),1)):f("",!0),n.key==="time"?(m(),g("div",qt,[p("div",null,"下单: "+u(x(o.createdAt)),1),o.paymentTime?(m(),g("div",Yt," 支付: "+u(x(o.paymentTime)),1)):f("",!0)])):f("",!0),n.key==="action"?(m(),b(t(ge),{key:7},{default:a(()=>[l(t(N),{type:"link",onClick:()=>Me(o)},{default:a(()=>e[36]||(e[36]=[s(" 详情 ")])),_:2},1032,["onClick"]),o.status==="pending_payment"?(m(),b(t(Pe),{key:0,title:"确定取消该订单吗？",onConfirm:()=>we(o),"ok-text":"确定","cancel-text":"取消"},{default:a(()=>[l(t(N),{type:"link",danger:""},{default:a(()=>e[37]||(e[37]=[s("取消订单")])),_:1})]),_:2},1032,["onConfirm"])):f("",!0),o.status==="pending_delivery"?(m(),b(t(N),{key:1,type:"link",onClick:()=>Ie(o)},{default:a(()=>e[38]||(e[38]=[s(" 发货 ")])),_:2},1032,["onClick"])):f("",!0),o.status==="refund_pending"?(m(),b(t(N),{key:2,type:"link",onClick:()=>Ne(o)},{default:a(()=>e[39]||(e[39]=[s(" 处理退款 ")])),_:2},1032,["onClick"])):f("",!0),o.status==="completed"&&o.settlementStatus==="unsettled"?(m(),b(t(N),{key:3,type:"link",onClick:()=>De(o)},{default:a(()=>e[40]||(e[40]=[s(" 结算 ")])),_:2},1032,["onClick"])):f("",!0),l(t(N),{type:"link",onClick:()=>Ce(o)},{default:a(()=>e[41]||(e[41]=[s(" 备注 ")])),_:2},1032,["onClick"])]),_:2},1024)):f("",!0)]),_:1},8,["data-source","loading","pagination"])]),_:1}),l(t(xe),{tab:"退款订单",key:"refund"},{default:a(()=>[l(t(_e),{columns:K,"data-source":z.value,loading:q.value,pagination:k,onChange:Se,"row-key":"id"},{bodyCell:a(({column:n,record:o})=>[n.key==="orderInfo"?(m(),g("div",zt,[p("div",null,"订单号: "+u(o.orderNo),1),p("div",null,"用户: "+u(o.userName),1),p("div",null,"类型: "+u(ye(o.orderType)),1)])):f("",!0),n.key==="amount"?(m(),g("div",jt," ¥"+u(Number(o.totalAmount).toFixed(2)),1)):f("",!0),n.key==="status"?(m(),b(t(F),{key:2,color:me(o.status)},{default:a(()=>[s(u(ie(o.status)),1)]),_:2},1032,["color"])):f("",!0),n.key==="paymentStatus"?(m(),b(t(F),{key:3,color:ve(o.paymentStatus)},{default:a(()=>[s(u(pe(o.paymentStatus)),1)]),_:2},1032,["color"])):f("",!0),n.key==="settlementStatus"?(m(),b(t(F),{key:4,color:ce(o.settlementStatus)},{default:a(()=>[s(u(fe(o.settlementStatus)),1)]),_:2},1032,["color"])):f("",!0),n.key==="settlementAmount"?(m(),g("div",Lt,u(o.settlementAmount?`¥${Number(o.settlementAmount).toFixed(2)}`:"-"),1)):f("",!0),n.key==="time"?(m(),g("div",Zt,[p("div",null,"下单: "+u(x(o.createdAt)),1),o.paymentTime?(m(),g("div",Bt," 支付: "+u(x(o.paymentTime)),1)):f("",!0)])):f("",!0),n.key==="action"?(m(),b(t(ge),{key:7},{default:a(()=>[l(t(N),{type:"link",onClick:()=>Me(o)},{default:a(()=>e[42]||(e[42]=[s(" 详情 ")])),_:2},1032,["onClick"]),o.status==="pending_payment"?(m(),b(t(Pe),{key:0,title:"确定取消该订单吗？",onConfirm:()=>we(o),"ok-text":"确定","cancel-text":"取消"},{default:a(()=>[l(t(N),{type:"link",danger:""},{default:a(()=>e[43]||(e[43]=[s("取消订单")])),_:1})]),_:2},1032,["onConfirm"])):f("",!0),o.status==="pending_delivery"?(m(),b(t(N),{key:1,type:"link",onClick:()=>Ie(o)},{default:a(()=>e[44]||(e[44]=[s(" 发货 ")])),_:2},1032,["onClick"])):f("",!0),o.status==="refund_pending"?(m(),b(t(N),{key:2,type:"link",onClick:()=>Ne(o)},{default:a(()=>e[45]||(e[45]=[s(" 处理退款 ")])),_:2},1032,["onClick"])):f("",!0),o.status==="completed"&&o.settlementStatus==="unsettled"?(m(),b(t(N),{key:3,type:"link",onClick:()=>De(o)},{default:a(()=>e[46]||(e[46]=[s(" 结算 ")])),_:2},1032,["onClick"])):f("",!0),l(t(N),{type:"link",onClick:()=>Ce(o)},{default:a(()=>e[47]||(e[47]=[s(" 备注 ")])),_:2},1032,["onClick"])]),_:2},1024)):f("",!0)]),_:1},8,["data-source","loading","pagination"])]),_:1})]),_:1},8,["active-key"])]),_:1}),l(t(X),{visible:te.value,"onUpdate:visible":e[6]||(e[6]=n=>te.value=n),title:"订单详情",width:"800px",footer:null,"mask-closable":!0},{default:a(()=>[d.value?(m(),g("div",Vt,[l(t(re),{title:"基本信息",bordered:"",column:2},{default:a(()=>[l(t(y),{label:"订单号"},{default:a(()=>[s(u(d.value.orderNo),1)]),_:1}),l(t(y),{label:"下单时间"},{default:a(()=>[s(u(x(d.value.createdAt)),1)]),_:1}),l(t(y),{label:"用户"},{default:a(()=>[s(u(d.value.userName),1)]),_:1}),l(t(y),{label:"总金额"},{default:a(()=>[s(" ¥"+u(Number(d.value.totalAmount).toFixed(2)),1)]),_:1}),l(t(y),{label:"订单类型"},{default:a(()=>[s(u(ye(d.value.orderType)),1)]),_:1}),l(t(y),{label:"订单状态"},{default:a(()=>[l(t(F),{color:me(d.value.status)},{default:a(()=>[s(u(ie(d.value.status)),1)]),_:1},8,["color"])]),_:1}),l(t(y),{label:"支付状态"},{default:a(()=>[l(t(F),{color:ve(d.value.paymentStatus)},{default:a(()=>[s(u(pe(d.value.paymentStatus)),1)]),_:1},8,["color"])]),_:1}),l(t(y),{label:"结算状态"},{default:a(()=>[l(t(F),{color:ce(d.value.settlementStatus)},{default:a(()=>[s(u(fe(d.value.settlementStatus)),1)]),_:1},8,["color"])]),_:1}),l(t(y),{label:"支付方式",span:2},{default:a(()=>[s(u(d.value.paymentMethod||"-"),1)]),_:1}),l(t(y),{label:"支付时间",span:2},{default:a(()=>[s(u(d.value.paymentTime?x(d.value.paymentTime):"-"),1)]),_:1}),l(t(y),{label:"发货时间",span:2},{default:a(()=>[s(u(d.value.deliveryTime?x(d.value.deliveryTime):"-"),1)]),_:1}),l(t(y),{label:"完成时间",span:2},{default:a(()=>[s(u(d.value.completionTime?x(d.value.completionTime):"-"),1)]),_:1}),l(t(y),{label:"结算时间",span:2},{default:a(()=>[s(u(d.value.settlementTime?x(d.value.settlementTime):"-"),1)]),_:1}),l(t(y),{label:"结算金额",span:2},{default:a(()=>[s(u(d.value.settlementAmount?`¥${Number(d.value.settlementAmount).toFixed(2)}`:"-"),1)]),_:1}),l(t(y),{label:"结算备注",span:2},{default:a(()=>[s(u(d.value.settlementRemark||"-"),1)]),_:1}),l(t(y),{label:"备注",span:2},{default:a(()=>[s(u(d.value.remark||"-"),1)]),_:1})]),_:1}),l(t(ne)),l(t(re),{title:"商家信息",bordered:"",column:2},{default:a(()=>[l(t(y),{label:"商家名称"},{default:a(()=>{var n;return[s(u(((n=d.value.merchant)==null?void 0:n.name)||"-"),1)]}),_:1}),l(t(y),{label:"商家用户名"},{default:a(()=>{var n;return[s(u(((n=d.value.merchant)==null?void 0:n.username)||"-"),1)]}),_:1}),l(t(y),{label:"联系电话"},{default:a(()=>{var n;return[s(u(((n=d.value.merchant)==null?void 0:n.phone)||"-"),1)]}),_:1}),l(t(y),{label:"邮箱地址"},{default:a(()=>{var n;return[s(u(((n=d.value.merchant)==null?void 0:n.email)||"-"),1)]}),_:1}),l(t(y),{label:"角色类型",span:2},{default:a(()=>{var n;return[l(t(F),{color:((n=d.value.merchant)==null?void 0:n.role)==="admin"?"red":"blue"},{default:a(()=>{var o;return[s(u(((o=d.value.merchant)==null?void 0:o.role)==="admin"?"超级管理员":"商家用户"),1)]}),_:1},8,["color"])]}),_:1})]),_:1}),l(t(ne)),l(t(re),{title:"商家收款信息",bordered:"",column:1},{default:a(()=>{var n,o,i,c,h,P;return[(i=(o=(n=d.value.merchant)==null?void 0:n.paymentMethods)==null?void 0:o.qrCodes)!=null&&i.length?(m(),b(t(y),{key:0,label:"收款码"},{default:a(()=>[p("div",Ht,[(m(!0),g(Re,null,Fe(d.value.merchant.paymentMethods.qrCodes,(w,W)=>(m(),g("div",{key:W,class:"qrcode-item"},[p("div",Gt,[l(t(F),{color:nt(w.type)},{default:a(()=>[s(u(lt(w.type)),1)]),_:2},1032,["color"]),p("span",Et,u(w.name),1)]),p("div",Jt,[p("img",{src:w.imageUrl,alt:w.name,class:"qrcode-img",onError:ot},null,40,Wt)])]))),128))])]),_:1})):(m(),b(t(y),{key:1,label:"收款码"},{default:a(()=>e[48]||(e[48]=[p("span",{class:"no-data"},"暂无收款码信息",-1)])),_:1})),(P=(h=(c=d.value.merchant)==null?void 0:c.paymentMethods)==null?void 0:h.bankCards)!=null&&P.length?(m(),b(t(y),{key:2,label:"银行卡"},{default:a(()=>[p("div",Qt,[(m(!0),g(Re,null,Fe(d.value.merchant.paymentMethods.bankCards,(w,W)=>(m(),g("div",{key:W,class:"bankcard-item"},[p("div",Xt,[p("div",Kt,[e[49]||(e[49]=p("span",{class:"bankcard-label"},"银行名称：",-1)),p("span",ea,u(w.bankName),1)]),p("div",ta,[e[50]||(e[50]=p("span",{class:"bankcard-label"},"账户名：",-1)),p("span",aa,u(w.accountName),1)]),p("div",la,[e[51]||(e[51]=p("span",{class:"bankcard-label"},"卡号：",-1)),p("span",na,u(rt(w.cardNumber)),1)])])]))),128))])]),_:1})):(m(),b(t(y),{key:3,label:"银行卡"},{default:a(()=>e[52]||(e[52]=[p("span",{class:"no-data"},"暂无银行卡信息",-1)])),_:1}))]}),_:1}),l(t(ne)),l(t(re),{title:"收货信息",bordered:"",column:1},{default:a(()=>[l(t(y),{label:"收货人"},{default:a(()=>[s(u(d.value.consignee||"-"),1)]),_:1}),l(t(y),{label:"联系电话"},{default:a(()=>[s(u(d.value.phone||"-"),1)]),_:1}),l(t(y),{label:"收货地址"},{default:a(()=>[s(u(d.value.address||"-"),1)]),_:1})]),_:1}),l(t(ne)),e[53]||(e[53]=p("h3",null,"商品信息",-1)),l(t(_e),{columns:ee,"data-source":d.value.items,pagination:!1,"row-key":"id"},{bodyCell:a(({column:n,record:o})=>[n.key==="product"?(m(),g("div",ra,[o.productCover?(m(),g("img",{key:0,src:o.productCover,alt:"商品图片",class:"product-img"},null,8,oa)):f("",!0),p("div",null,u(o.productName),1)])):f("",!0),n.key==="price"?(m(),g("div",sa,"¥"+u(Number(o.price).toFixed(2)),1)):f("",!0),n.key==="total"?(m(),g("div",ua," ¥"+u(Number(o.totalAmount).toFixed(2)),1)):f("",!0)]),_:1},8,["data-source"])])):f("",!0)]),_:1},8,["visible"]),l(t(X),{visible:H.value,"onUpdate:visible":e[8]||(e[8]=n=>H.value=n),title:"订单备注",onOk:We,"confirm-loading":$.value,onCancel:Je,"ok-text":"确定","cancel-text":"取消"},{default:a(()=>[l(t(Q),{ref_key:"remarkFormRef",ref:oe,model:L,rules:qe,"label-col":{span:4},"wrapper-col":{span:18}},{default:a(()=>[l(t(A),{label:"备注",name:"remark"},{default:a(()=>[l(t(be),{value:L.remark,"onUpdate:value":e[7]||(e[7]=n=>L.remark=n),placeholder:"请输入订单备注",rows:4},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","confirm-loading"]),l(t(X),{visible:G.value,"onUpdate:visible":e[12]||(e[12]=n=>G.value=n),title:"订单发货",onOk:Xe,"confirm-loading":$.value,onCancel:Qe,"ok-text":"确定","cancel-text":"取消"},{default:a(()=>[l(t(Q),{ref_key:"shipFormRef",ref:se,model:D,rules:Ye,"label-col":{span:4},"wrapper-col":{span:18}},{default:a(()=>[l(t(A),{label:"快递公司",name:"trackingCompany"},{default:a(()=>[l(t(le),{value:D.trackingCompany,"onUpdate:value":e[9]||(e[9]=n=>D.trackingCompany=n),placeholder:"请输入快递公司名称"},null,8,["value"])]),_:1}),l(t(A),{label:"快递单号",name:"trackingNumber"},{default:a(()=>[l(t(le),{value:D.trackingNumber,"onUpdate:value":e[10]||(e[10]=n=>D.trackingNumber=n),placeholder:"请输入快递单号"},null,8,["value"])]),_:1}),l(t(A),{label:"发货图片"},{default:a(()=>[l(t(yt),{"file-list":B.value,"onUpdate:fileList":e[11]||(e[11]=n=>B.value=n),"list-type":"picture-card",action:je,headers:ze,name:"image","before-upload":Le,onChange:Ze},{default:a(()=>[B.value.length>=5?(m(),g("div",da,e[54]||(e[54]=[p("div",null,"最多上传5张",-1)]))):(m(),g("div",ia,[l(t($t)),e[55]||(e[55]=p("div",{style:{"margin-top":"8px"}},"上传",-1))]))]),_:1},8,["file-list"]),e[56]||(e[56]=p("div",{class:"upload-hint"}," 请上传发货图片，最多5张，支持jpg、png格式 ",-1))]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","confirm-loading"]),l(t(X),{visible:E.value,"onUpdate:visible":e[15]||(e[15]=n=>E.value=n),title:"处理退款申请",onOk:et,"confirm-loading":$.value,onCancel:Ke,"ok-text":"确定","cancel-text":"取消"},{default:a(()=>[l(t(Q),{ref_key:"statusFormRef",ref:ue,model:O,rules:Be,"label-col":{span:4},"wrapper-col":{span:18}},{default:a(()=>[l(t(A),{label:"操作结果",name:"status"},{default:a(()=>[l(t(ke),{value:O.status,"onUpdate:value":e[13]||(e[13]=n=>O.status=n),placeholder:"请选择操作结果"},{default:a(()=>[l(t(C),{value:"approved"},{default:a(()=>e[57]||(e[57]=[s("通过")])),_:1}),l(t(C),{value:"rejected"},{default:a(()=>e[58]||(e[58]=[s("拒绝")])),_:1})]),_:1},8,["value"])]),_:1}),l(t(A),{label:"备注",name:"remark"},{default:a(()=>[l(t(be),{value:O.remark,"onUpdate:value":e[14]||(e[14]=n=>O.remark=n),placeholder:"请输入备注",rows:4},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","confirm-loading"]),l(t(X),{visible:J.value,"onUpdate:visible":e[18]||(e[18]=n=>J.value=n),title:"订单结算",onOk:at,"confirm-loading":$.value,onCancel:tt,"ok-text":"确定","cancel-text":"取消"},{default:a(()=>[l(t(Q),{ref_key:"settlementFormRef",ref:de,model:R,rules:Ve,"label-col":{span:4},"wrapper-col":{span:18}},{default:a(()=>[l(t(A),{label:"结算金额",name:"settlementAmount"},{default:a(()=>[l(t(kt),{value:R.settlementAmount,"onUpdate:value":e[16]||(e[16]=n=>R.settlementAmount=n),min:.01,step:.01,precision:2,placeholder:"请输入结算金额","addon-before":"¥",style:{width:"100%"}},null,8,["value"])]),_:1}),l(t(A),{label:"结算备注",name:"remark"},{default:a(()=>[l(t(be),{value:R.remark,"onUpdate:value":e[17]||(e[17]=n=>R.remark=n),placeholder:"请输入结算备注",rows:4},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","confirm-loading"])]))}}),ha=gt(ma,[["__scopeId","data-v-356edc6f"]]);export{ha as default};
