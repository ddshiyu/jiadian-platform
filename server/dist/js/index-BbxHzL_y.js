var B=(C,I,w)=>new Promise((y,_)=>{var m=h=>{try{O(w.next(h))}catch(n){_(n)}},x=h=>{try{O(w.throw(h))}catch(n){_(n)}},O=h=>h.done?y(h.value):Promise.resolve(h.value).then(m,x);O((w=w.apply(C,I)).next())});import{I as Fe,O as qe,ao as $e,b as d,P as ce,Q as Ve,R as k,U as pe,W as J,X as M,S as K,B as S,aC as He,Z as fe,a0 as me,a4 as H,a5 as Ne,a6 as ve,aD as Ge,a3 as ee,a2 as Ye,a1 as te,_ as Je}from"./bootstrap-BBk6SY2t.js";import{A as o,a2 as X,d as Xe,c as ge,I as ae,r as U,o as We,a as P,b as g,z as s,g as a,B as f,G as le,H as ye,l as N,t as E,f as p,e as T,J as Qe,F as G}from"../jse/index-index-Pp9M58hi.js";import{i as Ze,w as Ke,x as et,y as tt,z as at,A as lt,B as ot,C as st,D as rt}from"./operation-UX5_STqx.js";import{C as he,P as oe}from"./index-BSDYYvsn.js";import{T as nt}from"./index-VmR0-qbv.js";import{P as it}from"./index-CixpByLt.js";var dt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"};function we(C){for(var I=1;I<arguments.length;I++){var w=arguments[I]!=null?Object(arguments[I]):{},y=Object.keys(w);typeof Object.getOwnPropertySymbols=="function"&&(y=y.concat(Object.getOwnPropertySymbols(w).filter(function(_){return Object.getOwnPropertyDescriptor(w,_).enumerable}))),y.forEach(function(_){ut(C,_,w[_])})}return C}function ut(C,I,w){return I in C?Object.defineProperty(C,I,{value:w,enumerable:!0,configurable:!0,writable:!0}):C[I]=w,C}var Q=function(I,w){var y=we({},I,w.attrs);return o(Fe,we({},y,{icon:dt}),null)};Q.displayName="UploadOutlined";Q.inheritAttrs=!1;var W={exports:{}},ct=W.exports,be;function pt(){return be||(be=1,function(C,I){(function(w,y){y()})(ct,function(){function w(n,i){return typeof i=="undefined"?i={autoBom:!1}:typeof i!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(n.type)?new Blob(["\uFEFF",n],{type:n.type}):n}function y(n,i,r){var c=new XMLHttpRequest;c.open("GET",n),c.responseType="blob",c.onload=function(){h(c.response,i,r)},c.onerror=function(){console.error("could not download file")},c.send()}function _(n){var i=new XMLHttpRequest;i.open("HEAD",n,!1);try{i.send()}catch(r){}return 200<=i.status&&299>=i.status}function m(n){try{n.dispatchEvent(new MouseEvent("click"))}catch(r){var i=document.createEvent("MouseEvents");i.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),n.dispatchEvent(i)}}var x=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof X=="object"&&X.global===X?X:void 0,O=x.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),h=x.saveAs||(typeof window!="object"||window!==x?function(){}:"download"in HTMLAnchorElement.prototype&&!O?function(n,i,r){var c=x.URL||x.webkitURL,b=document.createElement("a");i=i||n.name||"download",b.download=i,b.rel="noopener",typeof n=="string"?(b.href=n,b.origin===location.origin?m(b):_(b.href)?y(n,i,r):m(b,b.target="_blank")):(b.href=c.createObjectURL(n),setTimeout(function(){c.revokeObjectURL(b.href)},4e4),setTimeout(function(){m(b)},0))}:"msSaveOrOpenBlob"in navigator?function(n,i,r){if(i=i||n.name||"download",typeof n!="string")navigator.msSaveOrOpenBlob(w(n,r),i);else if(_(n))y(n,i,r);else{var c=document.createElement("a");c.href=n,c.target="_blank",setTimeout(function(){m(c)})}}:function(n,i,r,c){if(c=c||open("","_blank"),c&&(c.document.title=c.document.body.innerText="downloading..."),typeof n=="string")return y(n,i,r);var b=n.type==="application/octet-stream",L=/constructor/i.test(x.HTMLElement)||x.safari,A=/CriOS\/[\d]+/.test(navigator.userAgent);if((A||b&&L||O)&&typeof FileReader!="undefined"){var z=new FileReader;z.onloadend=function(){var D=z.result;D=A?D:D.replace(/^data:[^;]*;/,"data:attachment/file;"),c?c.location.href=D:location=D,c=null},z.readAsDataURL(n)}else{var Y=x.URL||x.webkitURL,j=Y.createObjectURL(n);c?c.location=j:location.href=j,c=null,setTimeout(function(){Y.revokeObjectURL(j)},4e4)}});x.saveAs=h.saveAs=h,C.exports=h})}(W)),W.exports}var ft=pt();const mt={class:"table-header"},vt={class:"table-action"},gt={key:0,class:"product-cover"},yt=["src"],ht={key:1,class:"price"},wt={key:2,class:"price"},bt={key:3},kt={key:4,class:"price"},xt=["onClick"],Pt=["onClick"],It={key:1,class:"disabled-text"},Rt={key:0,class:"form-item-help text-warning"},Ct={key:0},_t=["src"],Ut={key:1},Et={key:0},St={key:1},Tt={class:"import-content"},Ot={class:"upload-area"},Lt=Xe({__name:"index",setup(C){const I=qe(),w=$e(),y=ge(()=>{var t;return((t=w.userInfo)==null?void 0:t.role)==="admin"}),_=[{title:"商品图片",dataIndex:"cover",key:"cover",width:100},{title:"商品名称",dataIndex:"name",key:"name"},{title:"价格",dataIndex:"price",key:"price",width:100},{title:"批发价",dataIndex:"wholesalePrice",key:"wholesalePrice",width:100},{title:"批发阈值",dataIndex:"wholesaleThreshold",key:"wholesaleThreshold",width:100},{title:"VIP价格",dataIndex:"vipPrice",key:"vipPrice",width:100},{title:"分类",dataIndex:"category",key:"category",customRender:({record:t})=>{var e;return((e=t.category)==null?void 0:e.name)||"-"}},{title:"库存",dataIndex:"stock",key:"stock",width:100},{title:"状态",dataIndex:"status",key:"status",width:100},{title:"推荐",dataIndex:"isRecommended",key:"isRecommended",width:80},{title:"创建时间",dataIndex:"createdAt",key:"createdAt",width:150},{title:"操作",key:"action",width:200}],m=ae({name:"",categoryId:null,status:null,isRecommended:null}),x=U([]),O=U([]),h=U(!1),n=ae({current:1,pageSize:10,total:0,showSizeChanger:!0,showTotal:t=>`共 ${t} 条数据`}),i=U(null),r=ae({id:0,name:"",description:"",price:0,originalPrice:0,wholesalePrice:0,wholesaleThreshold:0,vipPrice:0,stock:0,categoryId:void 0,status:"off_sale",cover:"",images:[],isRecommended:!1}),c={name:[{required:!0,message:"请输入商品名称",trigger:"blur"}],price:[{required:!0,message:"请输入商品价格",trigger:"blur"}],wholesalePrice:[{required:!0,message:"请输入批发价格",trigger:"blur"}],wholesaleThreshold:[{required:!0,message:"请输入批发阈值",trigger:"blur"}],vipPrice:[{required:!0,message:"请输入VIP价格",trigger:"blur"}],categoryId:[{required:!0,message:"请选择商品分类",trigger:"change"}],status:[{required:!0,message:"请选择商品状态",trigger:"change"}],stock:[{required:!0,message:"请输入库存数量",trigger:"blur"}]},b=U([]),L=U([]),A=U(!1),z=U(!1),Y=ge(()=>r.id?"编辑商品":"新增商品"),j=U(!1),D=U(!1),F=U([]),se={Authorization:`Bearer ${I.accessToken}`},re="https://qbylxb.cn/upload/image",ke=t=>{if(t.file.status!=="uploading")if(t.file.status==="done"){const e=t.file.response;e.code===0?(r.cover=`https://qbylxb.cn${e.data.image.url}`,d.success("封面图上传成功")):d.error("封面图上传失败")}else t.file.status==="error"&&d.error("封面图上传失败")},xe=t=>{const e=[...t.fileList].slice(0,5);L.value=e,t.file.status==="done"?t.file.response.code===0&&(r.images=L.value.filter(u=>{var v,$,V;return((V=($=(v=u.response)==null?void 0:v.data)==null?void 0:$.image)==null?void 0:V.url)||u.url}).map(u=>{var v,$,V;return`https://qbylxb.cn${(V=($=(v=u.response)==null?void 0:v.data)==null?void 0:$.image)==null?void 0:V.url}`}),d.success("商品图片上传成功")):t.file.status==="error"&&d.error("商品图片上传失败")};We(()=>{Pe(),q()});const Pe=()=>B(this,null,function*(){try{const t=yield Ze();t&&t.list&&(x.value=Ie(t.list))}catch(t){console.error("获取分类选项失败:",t),d.error("获取分类选项失败")}}),Ie=t=>t.filter(e=>!e.parentId||e.parentId===0).map(e=>({id:e.id,name:e.name})),q=()=>B(this,null,function*(){h.value=!0;try{const t={keyword:m.name,categoryId:m.categoryId||void 0,status:m.status||void 0,isRecommended:m.isRecommended,pageNum:n.current,pageSize:n.pageSize},e=yield Ke(t);e&&(O.value=e.list,n.total=e.total),h.value=!1}catch(t){console.error("获取商品列表失败:",t),d.error("获取商品列表失败"),h.value=!1}}),Re=t=>{t.current&&(n.current=t.current),t.pageSize&&(n.pageSize=t.pageSize),q()},Ce=()=>{n.current=1,q()},_e=()=>{Object.assign(m,{name:"",categoryId:null,status:null,isRecommended:null}),n.current=1,q()},Ue=()=>{Object.assign(r,{id:0,name:"",description:"",price:0,originalPrice:0,wholesalePrice:0,wholesaleThreshold:0,vipPrice:0,stock:0,categoryId:void 0,status:"off_sale",cover:"",images:[],isRecommended:!1}),b.value=[],L.value=[],A.value=!0},Ee=t=>B(this,null,function*(){try{h.value=!0;const e=yield et(t.id);if(h.value=!1,e){const l={id:e.id||0,name:e.name,description:e.description||"",price:e.price,originalPrice:e.originalPrice||0,wholesalePrice:e.wholesalePrice||0,wholesaleThreshold:e.wholesaleThreshold||0,vipPrice:e.vipPrice||0,stock:e.stock,categoryId:e.categoryId,status:e.status,cover:e.cover||"",images:e.images||[],isRecommended:e.isRecommended||!1};!y.value&&l.status==="on_sale"&&(l.status="off_sale",d.warning("非管理员用户编辑商品时将自动设置为下架状态")),Object.assign(r,l),b.value=e.cover?[{uid:"-1",name:"cover.jpg",url:e.cover}]:[],L.value=(e.images||[]).map((u,v)=>({uid:`-${v+1}`,name:`image-${v}.jpg`,url:u})),A.value=!0}}catch(e){h.value=!1,console.error("获取商品详情失败:",e),d.error("获取商品详情失败")}}),Se=t=>B(this,null,function*(){try{yield tt(t.id),d.success("删除成功"),q()}catch(e){console.error("删除商品失败:",e),d.error("删除商品失败")}}),Te=t=>B(this,null,function*(){try{const e=t.status==="on_sale"?"off_sale":"on_sale";if(!y.value&&e==="on_sale"){d.error("只有管理员可以将商品设置为上架状态");return}yield at(t.id,e),d.success(e==="on_sale"?"商品已上架":"商品已下架"),q()}catch(e){console.error("修改商品状态失败:",e),d.error("修改商品状态失败")}}),ne=()=>{A.value=!1},Oe=()=>B(this,null,function*(){if(i.value)try{if(yield i.value.validate(),!y.value&&r.status==="on_sale"){d.error("只有管理员可以将商品设置为上架状态");return}z.value=!0;const t={name:r.name,description:r.description,price:r.price,originalPrice:r.originalPrice,wholesalePrice:r.wholesalePrice||0,wholesaleThreshold:r.wholesaleThreshold||0,vipPrice:r.vipPrice||0,stock:r.stock,categoryId:r.categoryId,status:r.status,cover:r.cover,images:r.images,isRecommended:r.isRecommended};try{r.id?(yield lt(r.id,t),d.success("修改成功")):(yield ot(t),d.success("添加成功")),z.value=!1,A.value=!1,q()}catch(e){z.value=!1,console.error("保存商品失败:",e),d.error("保存商品失败")}}catch(t){console.error("表单验证失败:",t)}}),ie=t=>{const e=t.type==="image/jpeg"||t.type==="image/png";e||d.error("只能上传JPG或PNG格式的图片!");let l=!0;return t.size!==void 0&&(l=t.size/1024/1024<2),l||d.error("图片大小不能超过2MB!"),e&&l},Le=t=>t?Qe(t).format("YYYY-MM-DD HH:mm:ss"):"-",Ae=()=>B(this,null,function*(){try{console.log("开始下载模板...");const t=yield st();if(console.log("收到Blob:",{size:t.size,type:t.type}),!t||!(t instanceof Blob)||t.size===0)throw new Error("下载的文件为空或格式不正确");const e="商品导入模板.xlsx";try{ft.saveAs(t,e),d.success("模板下载成功")}catch(l){console.error("file-saver 保存失败:",l);const u=window.URL.createObjectURL(t),v=document.createElement("a");v.href=u,v.download=e,v.style.display="none",document.body.appendChild(v),v.click(),document.body.removeChild(v),window.URL.revokeObjectURL(u),d.success("模板下载成功")}}catch(t){console.error("下载模板失败:",t),d.error(`下载模板失败: ${t instanceof Error?t.message:"未知错误"}`)}}),je=()=>{F.value=[],j.value=!0},De=t=>{const e=t.type==="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"||t.type==="application/vnd.ms-excel";e||d.error("只能上传Excel格式的文件!");const l=(t.size||0)/1024/1024<10;return l||d.error("文件大小不能超过10MB!"),e&&l},Be=t=>{F.value=[...t.fileList].slice(-1)},Me=()=>B(this,null,function*(){var l,u,v,$,V;if(F.value.length===0){d.error("请选择要导入的Excel文件");return}const t=F.value[0];if(!(t!=null&&t.originFileObj)){d.error("文件格式错误");return}const e=t.originFileObj;try{D.value=!0,console.log("开始Excel导入，文件名:",e.name,"大小:",e.size);const R=yield rt(e);if(console.log("Excel导入响应:",R),R.success)d.success(`导入成功！成功导入 ${((l=R.data)==null?void 0:l.successCount)||0} 个商品`),j.value=!1,F.value=[],yield q();else throw new Error(R.message||"导入失败")}catch(R){if(console.error("Excel导入失败:",R),(v=(u=R.response)==null?void 0:u.data)!=null&&v.errors&&Array.isArray(R.response.data.errors)){const ue=R.response.data.errors,Z=R.response.data.totalErrors||ue.length;te.error({title:`导入失败 (共${Z}个错误)`,content:G("div",{style:"max-height: 300px; overflow-y: auto;"},[G("div",{style:"margin-bottom: 10px; color: #666;"},"请修正以下错误后重新导入："),G("ol",{style:"margin: 0; padding-left: 20px;"},ue.slice(0,20).map(ze=>G("li",{style:"margin-bottom: 5px;"},ze))),Z>20?G("div",{style:"margin-top: 10px; color: #999;"},`还有 ${Z-20} 个错误未显示...`):null]),width:600,okText:"我知道了"})}else(V=($=R.response)==null?void 0:$.data)!=null&&V.message?d.error(R.response.data.message):R.message?d.error(R.message):d.error("Excel导入失败，请检查文件格式")}finally{D.value=!1}}),de=()=>{F.value=[],j.value=!1};return(t,e)=>(g(),P("div",null,[o(a(he),{bordered:!1,class:"mb-20"},{default:s(()=>[o(a(ce),{model:m,layout:"inline",class:"search-form",onSubmit:Ve(Ce,["prevent"])},{default:s(()=>[o(a(k),{label:"商品名称"},{default:s(()=>[o(a(pe),{value:m.name,"onUpdate:value":e[0]||(e[0]=l=>m.name=l),placeholder:"请输入商品名称","allow-clear":""},null,8,["value"])]),_:1}),o(a(k),{label:"商品分类"},{default:s(()=>[o(a(J),{value:m.categoryId,"onUpdate:value":e[1]||(e[1]=l=>m.categoryId=l),placeholder:"请选择商品分类",style:{width:"200px"},"allow-clear":""},{default:s(()=>[o(a(M),{value:null},{default:s(()=>e[20]||(e[20]=[f("全部")])),_:1}),(g(!0),P(le,null,ye(x.value,l=>(g(),N(a(M),{key:l.id,value:l.id},{default:s(()=>[f(E(l.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),o(a(k),{label:"商品状态"},{default:s(()=>[o(a(J),{value:m.status,"onUpdate:value":e[2]||(e[2]=l=>m.status=l),placeholder:"请选择商品状态",style:{width:"200px"},"allow-clear":""},{default:s(()=>[o(a(M),{value:null},{default:s(()=>e[21]||(e[21]=[f("全部")])),_:1}),o(a(M),{value:"on_sale"},{default:s(()=>e[22]||(e[22]=[f("在售")])),_:1}),o(a(M),{value:"off_sale"},{default:s(()=>e[23]||(e[23]=[f("下架")])),_:1})]),_:1},8,["value"])]),_:1}),o(a(k),{label:"是否推荐"},{default:s(()=>[o(a(J),{value:m.isRecommended,"onUpdate:value":e[3]||(e[3]=l=>m.isRecommended=l),placeholder:"请选择是否推荐",style:{width:"200px"},"allow-clear":""},{default:s(()=>[o(a(M),{value:null},{default:s(()=>e[24]||(e[24]=[f("全部")])),_:1}),o(a(M),{value:"true"},{default:s(()=>e[25]||(e[25]=[f("推荐")])),_:1}),o(a(M),{value:"false"},{default:s(()=>e[26]||(e[26]=[f("不推荐")])),_:1})]),_:1},8,["value"])]),_:1}),o(a(k),null,{default:s(()=>[o(a(K),null,{default:s(()=>[o(a(S),{type:"primary","html-type":"submit"},{default:s(()=>e[27]||(e[27]=[f("查询")])),_:1}),o(a(S),{onClick:_e},{default:s(()=>e[28]||(e[28]=[f("重置")])),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),o(a(he),{bordered:!1},{default:s(()=>[p("div",mt,[e[32]||(e[32]=p("div",{class:"table-title"},"商品列表",-1)),p("div",vt,[o(a(K),null,{default:s(()=>[o(a(S),{onClick:Ae},{icon:s(()=>[o(a(He))]),default:s(()=>[e[29]||(e[29]=f(" 下载模板 "))]),_:1}),o(a(S),{onClick:je},{icon:s(()=>[o(a(Q))]),default:s(()=>[e[30]||(e[30]=f(" Excel导入 "))]),_:1}),o(a(S),{type:"primary",onClick:Ue},{icon:s(()=>[o(a(oe))]),default:s(()=>[e[31]||(e[31]=f(" 新增商品 "))]),_:1})]),_:1})])]),o(a(nt),{columns:_,"data-source":O.value,loading:h.value,pagination:n,onChange:Re,"row-key":"id"},{bodyCell:s(({column:l,record:u})=>[l.key==="cover"?(g(),P("div",gt,[p("img",{src:u.cover||"/images/default-product.png",alt:"商品图片"},null,8,yt)])):T("",!0),l.key==="price"?(g(),P("span",ht,"¥"+E(u.price),1)):T("",!0),l.key==="wholesalePrice"?(g(),P("span",wt,"¥"+E(u.wholesalePrice),1)):T("",!0),l.key==="wholesaleThreshold"?(g(),P("span",bt,E(u.wholesaleThreshold||"-")+" "+E(u.wholesaleThreshold?"件":""),1)):T("",!0),l.key==="vipPrice"?(g(),P("span",kt,"¥"+E(u.vipPrice),1)):T("",!0),l.key==="status"?(g(),N(a(fe),{key:5,color:u.status==="on_sale"?"green":"orange"},{default:s(()=>[f(E(u.status==="on_sale"?"在售":"下架"),1)]),_:2},1032,["color"])):T("",!0),l.key==="isRecommended"?(g(),N(a(fe),{key:6,color:u.isRecommended?"blue":"default"},{default:s(()=>[f(E(u.isRecommended?"是":"否"),1)]),_:2},1032,["color"])):T("",!0),l.key==="createdAt"?(g(),P(le,{key:7},[f(E(Le(u.createdAt)),1)],64)):T("",!0),l.key==="action"?(g(),N(a(K),{key:8},{default:s(()=>[p("a",{onClick:v=>Ee(u)},"编辑",8,xt),o(a(me),{type:"vertical"}),o(a(it),{title:"确定删除该商品吗？",onConfirm:v=>Se(u),"ok-text":"确定","cancel-text":"取消"},{default:s(()=>e[33]||(e[33]=[p("a",{class:"danger-link"},"删除",-1)])),_:2},1032,["onConfirm"]),o(a(me),{type:"vertical"}),y.value||u.status==="on_sale"?(g(),P("a",{key:0,onClick:v=>Te(u)},E(u.status==="on_sale"?"下架":"上架"),9,Pt)):(g(),P("span",It," 上架（需管理员权限） "))]),_:2},1024)):T("",!0)]),_:1},8,["data-source","loading","pagination"])]),_:1}),o(a(te),{visible:A.value,"onUpdate:visible":e[17]||(e[17]=l=>A.value=l),title:Y.value,width:"800px","mask-closable":!1,onCancel:ne},{footer:s(()=>[o(a(S),{onClick:ne},{default:s(()=>e[41]||(e[41]=[f("取消")])),_:1}),o(a(S),{type:"primary",loading:z.value,onClick:Oe},{default:s(()=>e[42]||(e[42]=[f(" 确定 ")])),_:1},8,["loading"])]),default:s(()=>[o(a(ce),{ref_key:"formRef",ref:i,model:r,rules:c,"label-col":{span:4},"wrapper-col":{span:18}},{default:s(()=>[o(a(k),{label:"商品名称",name:"name"},{default:s(()=>[o(a(pe),{value:r.name,"onUpdate:value":e[4]||(e[4]=l=>r.name=l),placeholder:"请输入商品名称"},null,8,["value"])]),_:1}),o(a(k),{label:"商品分类",name:"categoryId"},{default:s(()=>[o(a(J),{value:r.categoryId,"onUpdate:value":e[5]||(e[5]=l=>r.categoryId=l),placeholder:"请选择商品分类"},{default:s(()=>[(g(!0),P(le,null,ye(x.value,l=>(g(),N(a(M),{key:l.id,value:l.id},{default:s(()=>[f(E(l.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),o(a(k),{label:"商品价格",name:"price"},{default:s(()=>[o(a(H),{value:r.price,"onUpdate:value":e[6]||(e[6]=l=>r.price=l),placeholder:"请输入商品价格",min:0,precision:2,style:{width:"100%"}},null,8,["value"])]),_:1}),o(a(k),{label:"原价",name:"originalPrice"},{default:s(()=>[o(a(H),{value:r.originalPrice,"onUpdate:value":e[7]||(e[7]=l=>r.originalPrice=l),placeholder:"请输入商品原价",min:0,precision:2,style:{width:"100%"}},null,8,["value"])]),_:1}),o(a(k),{label:"批发价格",name:"wholesalePrice",required:""},{default:s(()=>[o(a(H),{value:r.wholesalePrice,"onUpdate:value":e[8]||(e[8]=l=>r.wholesalePrice=l),placeholder:"请输入批发价格",min:0,precision:2,style:{width:"100%"}},null,8,["value"])]),_:1}),o(a(k),{label:"批发阈值",name:"wholesaleThreshold",required:""},{default:s(()=>[o(a(H),{value:r.wholesaleThreshold,"onUpdate:value":e[9]||(e[9]=l=>r.wholesaleThreshold=l),placeholder:"请输入批发阈值（件）",min:0,style:{width:"100%"}},null,8,["value"]),e[34]||(e[34]=p("div",{class:"form-item-help"},"达到此数量可享受批发价",-1))]),_:1}),o(a(k),{label:"VIP价格",name:"vipPrice",required:""},{default:s(()=>[o(a(H),{value:r.vipPrice,"onUpdate:value":e[10]||(e[10]=l=>r.vipPrice=l),placeholder:"请输入VIP价格",min:0,precision:2,style:{width:"100%"}},null,8,["value"]),e[35]||(e[35]=p("div",{class:"form-item-help"},"VIP会员专享价格",-1))]),_:1}),o(a(k),{label:"库存",name:"stock"},{default:s(()=>[o(a(H),{value:r.stock,"onUpdate:value":e[11]||(e[11]=l=>r.stock=l),placeholder:"请输入库存数量",min:0,style:{width:"100%"}},null,8,["value"])]),_:1}),o(a(k),{label:"状态",name:"status"},{default:s(()=>[o(a(Ne),{value:r.status,"onUpdate:value":e[12]||(e[12]=l=>r.status=l)},{default:s(()=>[o(a(ve),{value:"on_sale",disabled:!y.value},{default:s(()=>e[36]||(e[36]=[f("上架")])),_:1},8,["disabled"]),o(a(ve),{value:"off_sale"},{default:s(()=>e[37]||(e[37]=[f("下架")])),_:1})]),_:1},8,["value"]),y.value?T("",!0):(g(),P("div",Rt," 提示：只有管理员可以将商品设置为上架状态 "))]),_:1}),o(a(k),{label:"是否推荐",name:"isRecommended"},{default:s(()=>[o(a(Ge),{checked:r.isRecommended,"onUpdate:checked":e[13]||(e[13]=l=>r.isRecommended=l),"checked-children":"是","un-checked-children":"否"},null,8,["checked"])]),_:1}),o(a(k),{label:"封面图",name:"cover"},{default:s(()=>[o(a(ee),{"file-list":b.value,"onUpdate:fileList":e[14]||(e[14]=l=>b.value=l),"list-type":"picture-card","show-upload-list":!1,action:re,headers:se,name:"image","before-upload":ie,onChange:ke},{default:s(()=>[r.cover?(g(),P("div",Ct,[p("img",{src:r.cover,alt:"商品封面",style:{width:"100%"}},null,8,_t)])):(g(),P("div",Ut,[o(a(oe)),e[38]||(e[38]=p("div",{style:{"margin-top":"8px"}},"上传",-1))]))]),_:1},8,["file-list"])]),_:1}),o(a(k),{label:"商品图片",name:"images"},{default:s(()=>[o(a(ee),{"file-list":L.value,"onUpdate:fileList":e[15]||(e[15]=l=>L.value=l),"list-type":"picture-card",action:re,headers:se,name:"image","before-upload":ie,onChange:xe},{default:s(()=>[L.value.length>=5?(g(),P("div",Et,e[39]||(e[39]=[p("div",null,"最多上传5张",-1)]))):(g(),P("div",St,[o(a(oe)),e[40]||(e[40]=p("div",{style:{"margin-top":"8px"}},"上传",-1))]))]),_:1},8,["file-list"])]),_:1}),o(a(k),{label:"商品描述",name:"description"},{default:s(()=>[o(a(Ye),{value:r.description,"onUpdate:value":e[16]||(e[16]=l=>r.description=l),placeholder:"请输入商品描述",rows:4},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title"]),o(a(te),{visible:j.value,"onUpdate:visible":e[19]||(e[19]=l=>j.value=l),title:"Excel批量导入商品",width:"600px","mask-closable":!1,onCancel:de},{footer:s(()=>[o(a(S),{onClick:de},{default:s(()=>e[46]||(e[46]=[f("取消")])),_:1}),o(a(S),{type:"primary",loading:D.value,onClick:Me},{default:s(()=>e[47]||(e[47]=[f(" 确认导入 ")])),_:1},8,["loading"])]),default:s(()=>[p("div",Tt,[e[45]||(e[45]=p("div",{class:"import-tips"},[p("h4",null,"导入说明："),p("ul",null,[p("li",null,"请先下载模板文件，按照模板格式填写商品信息"),p("li",null,"必填字段：商品名称、商品价格、批发价格、批发阈值、VIP价格、库存数量、分类ID、商品状态"),p("li",null,"商品状态只能填写：on_sale（上架）或 off_sale（下架）"),p("li",null,"是否推荐只能填写：true 或 false"),p("li",null,"分类ID请参考模板中的分类参考表"),p("li",null,"多张商品图片URL请用英文逗号分隔"),p("li",null,"文件大小不能超过10MB")])],-1)),p("div",Ot,[o(a(ee),{"file-list":F.value,"onUpdate:fileList":e[18]||(e[18]=l=>F.value=l),"before-upload":De,"max-count":1,accept:".xlsx,.xls",onChange:Be},{default:s(()=>[o(a(S),null,{icon:s(()=>[o(a(Q))]),default:s(()=>[e[43]||(e[43]=f(" 选择Excel文件 "))]),_:1})]),_:1},8,["file-list"]),e[44]||(e[44]=p("div",{class:"upload-tip"},"支持扩展名：.xlsx .xls",-1))])])]),_:1},8,["visible"])]))}}),qt=Je(Lt,[["__scopeId","data-v-c303789f"]]);export{qt as default};
