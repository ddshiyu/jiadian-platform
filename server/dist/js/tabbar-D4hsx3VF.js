var g=Object.defineProperty,y=Object.defineProperties;var I=Object.getOwnPropertyDescriptors;var d=Object.getOwnPropertySymbols;var p=Object.prototype.hasOwnProperty,x=Object.prototype.propertyIsEnumerable;var u=(t,e,s)=>e in t?g(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,T=(t,e)=>{for(var s in e||(e={}))p.call(e,s)&&u(t,s,e[s]);if(d)for(var s of d(e))x.call(e,s)&&u(t,s,e[s]);return t},l=(t,e)=>y(t,I(e));var w=(t,e)=>{var s={};for(var a in t)p.call(t,a)&&e.indexOf(a)<0&&(s[a]=t[a]);if(t!=null&&d)for(var a of d(t))e.indexOf(a)<0&&x.call(t,a)&&(s[a]=t[a]);return s};var h=(t,e,s)=>new Promise((a,n)=>{var i=b=>{try{o(s.next(b))}catch(m){n(m)}},f=b=>{try{o(s.throw(b))}catch(m){n(m)}},o=b=>b.done?a(b.value):Promise.resolve(b.value).then(i,f);o((s=s.apply(t,e)).next())});import{s as C,m as P,p as _,q as R,v}from"../jse/index-index-IK0MbYCQ.js";import{d as k}from"./bootstrap-Be81Tyra.js";const N=k("core-tabbar",{actions:{_bulkCloseByPaths(t){return h(this,null,function*(){this.tabs=this.tabs.filter(e=>!t.includes(c(e))),this.updateCacheTabs()})},_close(t){const{fullPath:e}=t;if(r(t))return;const s=this.tabs.findIndex(a=>a.fullPath===e);s!==-1&&this.tabs.splice(s,1)},_goToDefaultTab(t){return h(this,null,function*(){if(this.getTabs.length<=0)return;const e=this.getTabs[0];e&&(yield this._goToTab(e,t))})},_goToTab(t,e){return h(this,null,function*(){const{params:s,path:a,query:n}=t,i={params:s||{},path:a,query:n||{}};yield e.replace(i)})},addTab(t){var a,n;const e=B(t);if(!A(e))return;const s=this.tabs.findIndex(i=>c(i)===c(t));if(s===-1){const i=R.tabbar.maxCount,f=(n=(a=t==null?void 0:t.meta)==null?void 0:a.maxNumOfOpenTab)!=null?n:-1;if(f>0&&this.tabs.filter(o=>o.name===t.name).length>=f){const o=this.tabs.findIndex(b=>b.name===t.name);o!==-1&&this.tabs.splice(o,1)}else if(i>0&&this.tabs.length>=i){const o=this.tabs.findIndex(b=>!Reflect.has(b.meta,"affixTab")||!b.meta.affixTab);o!==-1&&this.tabs.splice(o,1)}this.tabs.push(e)}else{const i=v(this.tabs)[s],f=l(T(T({},i),e),{meta:T(T({},i==null?void 0:i.meta),e.meta)});if(i){const o=i.meta;Reflect.has(o,"affixTab")&&(f.meta.affixTab=o.affixTab),Reflect.has(o,"newTabTitle")&&(f.meta.newTabTitle=o.newTabTitle)}this.tabs.splice(s,1,f)}this.updateCacheTabs()},closeAllTabs(t){return h(this,null,function*(){const e=this.tabs.filter(s=>r(s));this.tabs=e.length>0?e:[...this.tabs].splice(0,1),yield this._goToDefaultTab(t),this.updateCacheTabs()})},closeLeftTabs(t){return h(this,null,function*(){const e=this.tabs.findIndex(n=>c(n)===c(t));if(e<1)return;const s=this.tabs.slice(0,e),a=[];for(const n of s)r(n)||a.push(c(n));yield this._bulkCloseByPaths(a)})},closeOtherTabs(t){return h(this,null,function*(){const e=this.tabs.map(a=>c(a)),s=[];for(const a of e)if(a!==t.fullPath){const n=this.tabs.find(i=>c(i)===a);if(!n)continue;r(n)||s.push(c(n))}yield this._bulkCloseByPaths(s)})},closeRightTabs(t){return h(this,null,function*(){const e=this.tabs.findIndex(s=>c(s)===c(t));if(e!==-1&&e<this.tabs.length-1){const s=this.tabs.slice(e+1),a=[];for(const n of s)r(n)||a.push(c(n));yield this._bulkCloseByPaths(a)}})},closeTab(t,e){return h(this,null,function*(){const{currentRoute:s}=e;if(c(s.value)!==c(t)){this._close(t),this.updateCacheTabs();return}const a=this.getTabs.findIndex(f=>c(f)===c(s.value)),n=this.getTabs[a-1],i=this.getTabs[a+1];i?(this._close(t),yield this._goToTab(i,e)):n?(this._close(t),yield this._goToTab(n,e)):console.error("Failed to close the tab; only one tab remains open.")})},closeTabByKey(t,e){return h(this,null,function*(){const s=decodeURIComponent(t),a=this.tabs.findIndex(i=>c(i)===s);if(a===-1)return;const n=this.tabs[a];n&&(yield this.closeTab(n,e))})},getTabByPath(t){return this.getTabs.find(e=>c(e)===t)},openTabInNewWindow(t){return h(this,null,function*(){_(t.fullPath||t.path)})},pinTab(t){return h(this,null,function*(){var n;const e=this.tabs.findIndex(i=>c(i)===c(t));if(e!==-1){const i=this.tabs[e];t.meta.affixTab=!0,t.meta.title=(n=i==null?void 0:i.meta)==null?void 0:n.title,this.tabs.splice(e,1,t)}const a=this.tabs.filter(i=>r(i)).findIndex(i=>c(i)===c(t));yield this.sortTabs(e,a)})},refresh(t){return h(this,null,function*(){const{currentRoute:e}=t,{name:s}=e.value;this.excludeCachedTabs.add(s),this.renderRouteView=!1,C(),yield new Promise(a=>setTimeout(a,200)),this.excludeCachedTabs.delete(s),this.renderRouteView=!0,P()})},resetTabTitle(t){return h(this,null,function*(){var s;if((s=t==null?void 0:t.meta)!=null&&s.newTabTitle)return;const e=this.tabs.find(a=>c(a)===c(t));e&&(e.meta.newTabTitle=void 0,yield this.updateCacheTabs())})},setAffixTabs(t){for(const e of t)e.meta.affixTab=!0,this.addTab(O(e))},setTabTitle(t,e){return h(this,null,function*(){const s=this.tabs.find(a=>c(a)===c(t));s&&(s.meta.newTabTitle=e,yield this.updateCacheTabs())})},setUpdateTime(){this.updateTime=Date.now()},sortTabs(t,e){return h(this,null,function*(){const s=this.tabs[t];s&&(this.tabs.splice(t,1),this.tabs.splice(e,0,s),this.dragEndIndex=this.dragEndIndex+1)})},toggleTabPin(t){return h(this,null,function*(){var s,a;yield((a=(s=t==null?void 0:t.meta)==null?void 0:s.affixTab)!=null?a:!1)?this.unpinTab(t):this.pinTab(t)})},unpinTab(t){return h(this,null,function*(){var n;const e=this.tabs.findIndex(i=>c(i)===c(t));if(e!==-1){const i=this.tabs[e];t.meta.affixTab=!1,t.meta.title=(n=i==null?void 0:i.meta)==null?void 0:n.title,this.tabs.splice(e,1,t)}const a=this.tabs.filter(i=>r(i)).length;yield this.sortTabs(e,a)})},updateCacheTabs(){return h(this,null,function*(){var e;const t=new Set;for(const s of this.tabs){if(!((e=s.meta)==null?void 0:e.keepAlive))continue;(s.matched||[]).forEach((i,f)=>{f>0&&t.add(i.name)});const n=s.name;t.add(n)}this.cachedTabs=t})}},getters:{affixTabs(){return this.tabs.filter(e=>r(e)).sort((e,s)=>{var i,f,o,b;const a=(f=(i=e.meta)==null?void 0:i.affixTabOrder)!=null?f:0,n=(b=(o=s.meta)==null?void 0:o.affixTabOrder)!=null?b:0;return a-n})},getCachedTabs(){return[...this.cachedTabs]},getExcludeCachedTabs(){return[...this.excludeCachedTabs]},getTabs(){const t=this.tabs.filter(e=>!r(e));return[...this.affixTabs,...t].filter(Boolean)}},persist:[{pick:["tabs"],storage:sessionStorage}],state:()=>({cachedTabs:new Set,dragEndIndex:0,excludeCachedTabs:new Set,renderRouteView:!0,tabs:[],updateTime:Date.now()})});function B(t){if(!t)return t;const n=t,{matched:e,meta:s}=n,a=w(n,["matched","meta"]);return l(T({},a),{matched:e?e.map(i=>({meta:i.meta,name:i.name,path:i.path})):void 0,meta:l(T({},s),{newTabTitle:s.newTabTitle})})}function r(t){var e,s;return(s=(e=t==null?void 0:t.meta)==null?void 0:e.affixTab)!=null?s:!1}function A(t){var s;const e=(s=t==null?void 0:t.matched)!=null?s:[];return!t.meta.hideInTab&&e.every(a=>!a.meta.hideInTab)}function c(t){return decodeURIComponent(t.fullPath||t.path)}function O(t){return{meta:t.meta,name:t.name,path:t.path}}export{N as u};
