var U=Object.defineProperty;var S=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,D=Object.prototype.propertyIsEnumerable;var P=(o,a,e)=>a in o?U(o,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[a]=e,y=(o,a)=>{for(var e in a||(a={}))q.call(a,e)&&P(o,e,a[e]);if(S)for(var e of S(a))D.call(a,e)&&P(o,e,a[e]);return o};var d=(o,a,e)=>new Promise((r,l)=>{var c=i=>{try{t(e.next(i))}catch(h){l(h)}},f=i=>{try{t(e.throw(i))}catch(h){l(h)}},t=i=>i.done?r(i.value):Promise.resolve(i.value).then(c,f);t((e=e.apply(o,a)).next())});import{u as H,M as j,_ as G,N as J,a as Z,b as F}from"./layout.vue_vue_type_script_setup_true_lang-CNegdYiS.js";import{f as Q,ch as Y,l as K,ci as X,cc as ee,$ as A,cj as ae,ck as te,a as oe,V as N}from"./bootstrap-DhTUe00I.js";import{P as v,ap as C,ax as ne,a1 as $,n as se,$ as re,a3 as E,a7 as le,a8 as ie,Y as z,J as b,a4 as ue,a5 as W,x as m,ah as g,aa as u,ak as ce,bJ as L,a0 as T,ao as de,ae as pe}from"../jse/index-index-DRKrrGAz.js";import{_ as me}from"./avatar.vue_vue_type_script_setup_true_lang-RQ7XFiG6.js";import"./theme-toggle.vue_vue_type_script_setup_true_lang-nq6BAIQJ.js";import"./TabsList.vue_vue_type_script_setup_true_lang-C8UsNqP4.js";import"./rotate-cw-BHgmBUkX.js";const fe=Q("BookOpenTextIcon",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M16 12h2",key:"7q9ll5"}],["path",{d:"M16 8h2",key:"msurwy"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}],["path",{d:"M6 12h2",key:"32wvfc"}],["path",{d:"M6 8h2",key:"30oboj"}]]),p=v(),R=v(!1),_=v({advancedStyle:{colorStops:[{color:"gray",offset:0},{color:"gray",offset:1}],type:"linear"},content:"",contentType:"multi-line-text",globalAlpha:.25,gridLayoutOptions:{cols:2,gap:[20,20],matrix:[[1,0],[0,1]],rows:2},height:200,layout:"grid",rotate:30,width:160});function he(){function o(r){return d(this,null,function*(){var c;const{Watermark:l}=yield re(()=>d(this,null,function*(){const{Watermark:f}=yield import("./index.esm-ChtR6blK.js");return{Watermark:f}}),[]);_.value=y(y({},_.value),r),p.value=new l(_.value),$({app:{watermark:!0}}),yield(c=p.value)==null?void 0:c.create()})}function a(r){return d(this,null,function*(){var l;p.value?(yield se(),yield(l=p.value)==null?void 0:l.changeOptions(y(y({},_.value),r))):yield o(r)})}function e(){p.value&&(p.value.destroy(),p.value=void 0),$({app:{watermark:!1}})}return R.value||(R.value=!0,C(()=>{e()})),{destroyWatermark:e,updateWatermark:a,watermark:ne(p)}}const ge=E({name:"LoginExpiredModal",__name:"login-expired-modal",props:le({avatar:{default:""},zIndex:{default:0},codeLoginPath:{},forgetPasswordPath:{},loading:{type:Boolean},qrCodeLoginPath:{},registerPath:{},showCodeLogin:{type:Boolean},showForgetPassword:{type:Boolean},showQrcodeLogin:{type:Boolean},showRegister:{type:Boolean},showRememberMe:{type:Boolean},showThirdPartyLogin:{type:Boolean},subTitle:{},title:{},submitButtonText:{}},{open:{type:Boolean},openModifiers:{}}),emits:["update:open"],setup(o){const a=o,e=ie(o,"open"),[r,l]=H();z(()=>e.value,t=>{l.setState({isOpen:t})});const c=b(()=>a.zIndex||f());function f(){let t=0;return[...document.querySelectorAll("*")].forEach(h=>{const w=window.getComputedStyle(h).getPropertyValue("z-index");w&&!Number.isNaN(Number.parseInt(w))&&(t=Math.max(t,Number.parseInt(w)))}),t+1}return(t,i)=>(W(),ue("div",null,[m(u(r),{closable:!1,"close-on-click-modal":!1,"close-on-press-escape":!1,footer:!1,"fullscreen-button":!1,header:!1,"z-index":c.value,class:"border-none px-10 py-6 text-center shadow-xl sm:w-[600px] sm:rounded-2xl md:h-[unset]"},{default:g(()=>[m(u(me),{src:t.avatar,class:"mx-auto mb-6 size-20"},null,8,["src"]),m(u(Y),{"show-forget-password":!1,"show-register":!1,"show-remember-me":!1,"sub-title":t.$t("authentication.loginAgainSubTitle"),title:t.$t("authentication.loginAgainTitle")},{default:g(()=>[ce(t.$slots,"default")]),_:3},8,["sub-title","title"])]),_:3},8,["z-index"])]))}}),Le=E({__name:"basic",setup(o){const a=v([]),e=v(!1),r=K(),l=X(),c=ee(),{destroyWatermark:f,updateWatermark:t}=he(),i=b(()=>a.value.some(n=>!n.isRead)),h=b(()=>[{handler:()=>{L(oe,{target:"_blank"})},icon:fe,text:A("ui.widgets.document")},{handler:()=>{L(N,{target:"_blank"})},icon:j,text:"GitHub"},{handler:()=>{L(`${N}/issues`,{target:"_blank"})},icon:ae,text:A("ui.widgets.qa")}]),k=b(()=>{var n,s;return(s=(n=r.userInfo)==null?void 0:n.avatar)!=null?s:T.app.defaultAvatar}),w=()=>d(this,null,function*(){e.value=!0;try{const n=yield getMessageListApi({pageNum:1,pageSize:10});a.value=n.row.map(s=>({id:s.id,title:s.title,message:s.content,isRead:s.isRead===1,date:new Date().toLocaleString(),avatar:""}))}catch(n){console.error("获取消息失败")}finally{e.value=!1}}),B=n=>d(this,null,function*(){});function M(){return d(this,null,function*(){yield l.logout(!1)})}function O(){a.value=[]}function V(){a.value.forEach(n=>{n.isRead=!0,B()})}z(()=>T.app.watermark,n=>d(this,null,function*(){var s;n?yield t({content:`${(s=r.userInfo)==null?void 0:s.username}`}):f()}),{immediate:!0});const I=v(null);return de(()=>{I.value=setInterval(()=>{w()},1e4)}),C(()=>{clearInterval(I.value)}),(n,s)=>(W(),pe(u(F),{onClearPreferencesAndLogout:M},{"user-dropdown":g(()=>{var x;return[m(u(Z),{avatar:k.value,menus:h.value,text:(x=u(r).userInfo)==null?void 0:x.realName,description:"ann.vben@gmail.com","tag-text":"Pro",onLogout:M},null,8,["avatar","menus","text"])]}),notification:g(()=>[m(u(J),{dot:i.value,loading:e.value,notifications:a.value,onClear:O,onMakeAll:V,onRead:B},null,8,["dot","loading","notifications"])]),extra:g(()=>[m(u(ge),{open:u(c).loginExpired,"onUpdate:open":s[0]||(s[0]=x=>u(c).loginExpired=x),avatar:k.value},{default:g(()=>[m(te)]),_:1},8,["open","avatar"])]),"lock-screen":g(()=>[m(u(G),{avatar:k.value,onToLogin:M},null,8,["avatar"])]),_:1}))}});export{Le as default};
